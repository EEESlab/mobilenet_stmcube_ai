# Mobilenet on STMH7 using STMCube AI

The repo contains a STMWorkbench project that aims to fit a Mobilenet v1 (`3,160,160`, alpha=`0.25`) into a MCU STM32H7 using the STMCubeMX.AI flow.

This project will be used as reference benchmark of our **Quantized Mobilenet** based on`CMSIS-NN`: https://github.com/EEESlab/mobilenet_v1_stm32_cmsis_nn

## Content
The project folder structure follows the classic STMWorkbench project template. In addition it contains the code generated by STMCubeMX.AI for the Mobilenet included inside the folder `keras_model/`:
- `Drivers/`: *(generated)* The Folder contains the ARM `CMSIS` and additional drivers for the MCU;
- `Middlewares/ST/AI/AI/`: *(generated)* `STMCubeMX.AI` generated code for the Mobilenet.
- `Src/`: *(generated)* Project Headers
- `Src/main.c`: Main application that contains the usage of the generated Mobilenet code.
- `keras_model/`: The folder contains a Python notebook used to fix and convert the Keras Mobilenet pre-trained model to a model that can be imported into the STMCubeMX.AI flow. According to the discussion [\[1\]](https://community.st.com/s/question/0D50X0000AVUpc1SQD/keras-import-not-implemented-unsupported-layer-type-relu), *keras.advanced_activations.ReLU* layers are not usable directly in STCubemx.ai. The function remove such layers and it substitutes to supported *keras.activations.relu*.

## Current Status
- [X] Mobilenet can be imported from Keras to STMCubeMX.AI.
- [X] Added `main.c` application.
- [ ] Compile and Link. **The application at the moment do not fit into the SRAM!**
- [ ] Test.
